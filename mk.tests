#!/bin/sh

################################################################################
#FUNCTIONS
pause() {
	echo "=================== Press [Enter] to continue ==================="
	read frak
}


################################################################################
#TESTING

#TESTING BASIC METADATA FUNCTIONALITY

echo "TESTING BASIC METADATA FUNCTIONALITY"
echo "Adding metadata to README.txt"

echo "This is README.txt" > README.txt 
echo "cat README.txt"
cat README.txt

./metatag README.txt "This file is awesome!"

echo "metacat README.txt"
./metacat README.txt

echo "cat README.txt"
cat README.txt

pause

#TESTING COPYING FILE COPIES METADATA

echo "TESTING COPYING FILE COPIES METADATA"

echo "README.txt original metadata"
./metacat README.txt

echo "Copying README.txt to README2.txt"
cp README.txt README2.txt

echo "metacat README2.txt"
./metacat README2.txt

pause

#TESTING CHANGING METADATA OF ORIGINAL DOESN'T CHANGE COPY

echo "TESTING CHANGING METADATA OF ORIGINAL DOESN'T CHANGE COPY"

echo "Changing metadata of README.txt to Hello World!"
./metatag README.txt "Hello World!"

echo "metacat README.txt"
./metacat README.txt
echo "metacat README2.txt"
./metacat README2.txt

pause

#TESTING CHANGING FILE CONTENT DOES NOT AFFECT METADATA

echo "TESTING CHANGING FILE CONTENT DOES NOT AFFECT METADATA"
echo "Original metadata for README.txt"
./metacat README.txt

echo "Changing README.txt contents"
echo "New contents!" > README.txt

echo "cat README.txt"
cat README.txt

echo "metacat README.txt"
./metacat README.txt

pause

#TESTING CHANGING METADATA DOES NOT CHANGE FILE CONTENT

echo "TESTING CHANGING METADATA DOES NOT CHANGE FILE CONTENT"

echo "Original metadata for README.txt"
./metacat README.txt

echo "cat README.txt"
cat README.txt

echo "metatag README.txt 'New Tag'"
./metatag README.txt "New Tag"

echo "metacat README.txt"
./metacat README.txt

pause

#TESTING FOR MEMORY LEAKS

echo "TESTING FOR MEMORY LEAKS"

echo "Initial free space"
df

echo "Creating and deleting 1000 files with metadata"
max = 1000
for i in 'seq 2 $max'
do
	echo "stuff" > file.txt
	./metatag file.txt "new tag"
	rm file.txt
done

echo "Ending free space"
df

pause

################################################################################
